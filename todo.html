<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>StudyMind - AI-Powered Learning Assistant</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <link href="https://ai-public.creatie.ai/gen_page/tailwind-custom.css" rel="stylesheet"/>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com/3.4.5?plugins=forms@0.5.7,typography@0.5.13,aspect-ratio@0.4.2,container-queries@0.1.1"></script>
  <script src="https://ai-public.creatie.ai/gen_page/tailwind-config.min.js" data-color="#000000" data-border-radius="small"></script>

  <style>
    .perspective-1000 { perspective: 1000px; }
    .backface-hidden { backface-visibility: hidden; }
    .transform-style-preserve-3d { transform-style: preserve-3d; }
    .rotate-y-180 { transform: rotateY(180deg); }
    .flashcard-container:hover .flashcard-inner { transform: rotateY(180deg); }

    /* Replace default blue with black */
    .bg-custom {
      background-color: #000000 !important;
    }
    .text-custom {
      color: #000000 !important;
    }
    .hover\:text-custom-dark:hover {
      color: #333333 !important;
    }

    /* Dark mode styles (unified) */
    .dark-mode {
      background-color: #121212 !important;
      color: #e0e0e0 !important;
    }
    .dark-mode nav,
    .dark-mode .secondary-nav,
    .dark-mode .bg-white,
    .dark-mode main .bg-white {
      background-color: #1e1e1e !important;
    }
    .dark-mode .text-gray-900 {
      color: #e0e0e0 !important;
    }
    .dark-mode .text-gray-700,
    .dark-mode .text-gray-600,
    .dark-mode .text-gray-500 {
      color: #a0a0a0 !important;
    }
    .dark-mode .border-gray-200,
    .dark-mode nav.border-b,
    .dark-mode .secondary-nav.border-b,
    .dark-mode .border-l,
    .dark-mode tbody.divide-y {
      border-color: #333333 !important;
    }
    .dark-mode .bg-gray-50,
    .dark-mode .bg-gray-100,
    .dark-mode thead.bg-gray-50 {
      background-color: #2c2c2c !important;
    }
    .dark-mode .shadow-sm {
      box-shadow: 0 1px 2px 0 rgba(0,0,0,0.5)!important;
    }
    .dark-mode tbody.bg-white,
    .dark-mode tr {
      background-color: #1e1e1e !important;
    }
    .dark-mode .bg-red-100 {
      background-color: rgba(220,38,38,0.2)!important;
    }
    .dark-mode .bg-yellow-100 {
      background-color: rgba(234,179,8,0.2)!important;
    }
    .dark-mode .bg-green-100 {
      background-color: rgba(22,163,74,0.2)!important;
    }
    .dark-mode .text-red-800 {
      color: #fca5a5 !important;
    }
    .dark-mode .text-yellow-800 {
      color: #fde68a !important;
    }
    .dark-mode .text-green-800 {
      color: #86efac !important;
    }
    .dark-mode .text-custom {
      color: #333333 !important;
    }
    .dark-mode .hover\:text-custom-dark:hover {
      color: #666666 !important;
    }
    .dark-mode .bg-custom {
      background-color: #000000 !important;
    }
    .dark-mode input[type="checkbox"] {
      background-color: #333333 !important;
      border-color: #555555 !important;
    }
    .dark-mode a.border-transparent {
      color: #a0a0a0 !important;
    }
    .dark-mode a.border-custom {
      color: #e0e0e0 !important;
    }
    .dark-mode a.hover\:text-gray-700:hover {
      color: #e0e0e0 !important;
    }
    .dark-mode a.hover\:border-gray-300:hover {
      border-color: #555555 !important;
    }
    .dark-mode select.bg-transparent {
      color: #a0a0a0 !important;
    }
    .dark-mode select.bg-transparent option {
      background-color: #1e1e1e !important;
      color: #a0a0a0 !important;
    }
    /* Transition overrides for dark mode toggling */
    body, nav, .secondary-nav, .bg-white, main .bg-white, .text-gray-900, .text-gray-700, 
    .text-gray-600, .text-gray-500, .border-gray-200, nav.border-b, .secondary-nav.border-b, 
    .border-l, tbody.divide-y, .bg-gray-50, .bg-gray-100, thead.bg-gray-50, .shadow-sm, 
    tbody.bg-white, tr, .bg-red-100, .bg-yellow-100, .bg-green-100, .text-red-800, 
    .text-yellow-800, .text-green-800, .text-custom, .hover\:text-custom-dark:hover,
    .bg-custom, input[type="checkbox"], a.border-transparent, a.border-custom,
    a.hover\:text-gray-700:hover, a.hover\:border-gray-300:hover,
    select.bg-transparent, select.bg-transparent option {
      transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease !important;
    }

    /* Modal Styles */
    .modal-overlay {
      position: fixed; inset: 0; background-color: rgba(0,0,0,0.5);
      display: none; z-index: 50;
    }
    .modal {
      background-color: #fff;
      width: 100%; max-width: 520px; margin: 100px auto;
      border-radius: 0.5rem; padding: 1.5rem; position: relative;
    }
    .dark-mode .modal { background-color: #1e1e1e!important; }
    .modal-active .modal-overlay { display: block; }
    .filter-modal { max-width: 600px; }
  </style>
</head>
<body class="bg-gray-50 font-sans">
  <nav class="bg-white border-b border-gray-200">
    <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16">
        <div class="flex">
          <div class="flex-shrink-0 flex items-center">
            <img class="h-8 w-auto" src="logo.png" alt="StudyMind"/>
          </div>
          <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
            <a href="dashboard.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Dashboard</a>
            <a href="ai notes.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">AI Notes</a>
            <a href="flashcards.html" class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Flashcards</a>
            <a href="todo.html" class="border-custom text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium">Tasks &amp; To-Do</a>
          </div>
        </div>
        <div class="flex items-center">
          <div class="ml-4 relative">
            <div class="flex items-center">
              <button class="bg-gray-800 flex text-sm rounded-full focus:outline-none">
                <img class="h-8 w-8 rounded-full" src="https://creatie.ai/ai/api/search-image?query=A%20professional%20headshot..." alt=""/>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>
  <div class="bg-white border-b border-gray-200 py-2 secondary-nav">
    <div class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-end space-x-4 items-center">
        <button id="darkModeToggle" class="flex items-center text-sm text-gray-600">
          <i class="fas fa-moon mr-2" id="darkModeIcon"></i>
          <span id="darkModeText">Dark Mode</span>
        </button>
        <div class="border-l border-gray-200 h-4 mx-2"></div>
        <button class="flex items-center text-sm text-gray-600">
          <i class="fas fa-bell mr-2"></i>Notifications
        </button>
        <div class="border-l border-gray-200 h-4 mx-2"></div>
        <select class="text-sm text-gray-600 bg-transparent border-none">
          <option>English</option>
          <option>Spanish</option>
          <option>French</option>
        </select>
      </div>
    </div>
  </div>
  <main class="max-w-8xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="bg-white rounded-lg shadow-sm p-6 mb-8">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
        <div>
          <h1 class="text-4xl font-bold text-gray-900 mb-4">Task Management</h1>
          <p class="text-lg text-gray-600 mb-6">Organize and track your tasks efficiently</p>
          <button id="addTaskBtn" class="bg-custom text-white !rounded-button px-6 py-3 text-base font-medium inline-flex items-center">
            <i class="fas fa-plus mr-2"></i>Add New Task
          </button>
          <button id="openFilterBtn" class="ml-4 bg-gray-100 text-gray-700 !rounded-button px-6 py-3 text-base font-medium inline-flex items-center">
            <i class="fas fa-filter mr-2"></i>Filter Tasks
          </button>
        </div>
        <div class="hidden lg:block">
          <!-- <img src="img.png" alt="Study Illustration" class="w-full h-auto"/> -->
        </div>
      </div>
    </div>
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8 mb-8">
      <div class="bg-white rounded-lg shadow-sm p-6 col-span-4">
        <div class="flex justify-between items-center mb-6">
          <h2 class="text-xl font-semibold">Tasks</h2>
          <div class="flex space-x-4">
            <button id="filterAllBtn" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm">All</button>
            <button id="filterTodayBtn" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm">Today</button>
            <button id="filterUpcomingBtn" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm">Upcoming</button>
          </div>
        </div>
        <table class="min-w-full">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Task</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Due Date</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Priority</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
          </thead>
          <tbody id="taskTableBody" class="bg-white divide-y divide-gray-200">
            <!-- Tasks appended here dynamically -->
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- Add/Edit Task Modal -->
  <div id="modalOverlay" class="modal-overlay">
    <div class="modal relative">
      <button type="button" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700" id="taskModalCloseBtn">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="text-xl font-semibold mb-4" id="modalTitle">Add New Task</h3>
      <form id="taskForm" class="space-y-4">
        <div>
          <label for="taskName" class="block text-sm font-medium">Task Name</label>
          <input type="text" id="taskName" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" required />
        </div>
        <div>
          <label for="taskDescription" class="block text-sm font-medium">Description</label>
          <input type="text" id="taskDescription" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
        </div>
        <div>
          <label for="taskDueDate" class="block text-sm font-medium">Due Date</label>
          <input type="date" id="taskDueDate" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" required />
        </div>
        <div>
          <label for="taskPriority" class="block text-sm font-medium">Priority</label>
          <select id="taskPriority" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
            <option value="High">High</option>
            <option value="Medium" selected>Medium</option>
            <option value="Low">Low</option>
          </select>
        </div>
        <div>
          <label for="taskStatus" class="block text-sm font-medium">Status</label>
          <select id="taskStatus" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm">
            <option value="Not Started">Not Started</option>
            <option value="In Progress" selected>In Progress</option>
            <option value="Completed">Completed</option>
          </select>
        </div>
        <div class="flex justify-end pt-4">
          <button type="button" id="cancelBtn" class="mr-4 px-4 py-2 bg-gray-200 rounded-md">Cancel</button>
          <button type="submit" id="saveTaskBtn" class="px-4 py-2 bg-custom text-white rounded-md">Save</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Advanced Filter Modal -->
  <div id="filterModalOverlay" class="modal-overlay">
    <div class="modal filter-modal relative">
      <button type="button" class="absolute top-3 right-3 text-gray-500 hover:text-gray-700" id="filterModalCloseBtn">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="text-xl font-semibold mb-4">Advanced Filters</h3>
      <form id="filterForm" class="space-y-4">
        <div>
          <label for="filterText" class="block text-sm font-medium">Search (Name / Description)</label>
          <input type="text" id="filterText" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" placeholder="e.g. 'meeting', 'draft'"/>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label for="filterDateFrom" class="block text-sm font-medium">Date From</label>
            <input type="date" id="filterDateFrom" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
          </div>
          <div>
            <label for="filterDateTo" class="block text-sm font-medium">Date To</label>
            <input type="date" id="filterDateTo" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm" />
          </div>
        </div>
        <div>
          <p class="text-sm font-medium mb-1">Priority</p>
          <div class="flex items-center space-x-4">
            <label class="inline-flex items-center">
              <input type="checkbox" class="priority-checkbox" value="High"/> 
              <span class="ml-2">High</span>
            </label>
            <label class="inline-flex items-center">
              <input type="checkbox" class="priority-checkbox" value="Medium"/>
              <span class="ml-2">Medium</span>
            </label>
            <label class="inline-flex items-center">
              <input type="checkbox" class="priority-checkbox" value="Low"/>
              <span class="ml-2">Low</span>
            </label>
          </div>
        </div>
        <div>
          <p class="text-sm font-medium mb-1">Status</p>
          <div class="flex items-center space-x-4">
            <label class="inline-flex items-center">
              <input type="checkbox" class="status-checkbox" value="Not Started"/>
              <span class="ml-2">Not Started</span>
            </label>
            <label class="inline-flex items-center">
              <input type="checkbox" class="status-checkbox" value="In Progress"/>
              <span class="ml-2">In Progress</span>
            </label>
            <label class="inline-flex items-center">
              <input type="checkbox" class="status-checkbox" value="Completed"/>
              <span class="ml-2">Completed</span>
            </label>
          </div>
        </div>
        <div class="flex justify-end pt-4">
          <button type="button" id="clearFilterBtn" class="mr-4 px-4 py-2 bg-gray-200 rounded-md">Clear</button>
          <button type="submit" class="px-4 py-2 bg-custom text-white rounded-md">Apply</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    /*******************************
     *       DARK MODE TOGGLE
     *******************************/
    document.addEventListener('DOMContentLoaded', function() {
      const darkModeToggle = document.getElementById('darkModeToggle');
      const darkModeIcon = document.getElementById('darkModeIcon');
      const darkModeText = document.getElementById('darkModeText');
      const isDarkMode = localStorage.getItem('darkMode') === 'true';
      if (isDarkMode) enableDarkMode();

      function enableDarkMode() {
        document.body.classList.add('dark-mode');
        darkModeIcon.classList.remove('fa-moon');
        darkModeIcon.classList.add('fa-sun');
        darkModeText.textContent = 'Light Mode';
        localStorage.setItem('darkMode', 'true');
      }
      function disableDarkMode() {
        document.body.classList.remove('dark-mode');
        darkModeIcon.classList.remove('fa-sun');
        darkModeIcon.classList.add('fa-moon');
        darkModeText.textContent = 'Dark Mode';
        localStorage.setItem('darkMode', 'false');
      }
      if (isDarkMode) enableDarkMode();

      darkModeToggle.addEventListener('click', function() {
        if (document.body.classList.contains('dark-mode')) {
          disableDarkMode();
        } else {
          enableDarkMode();
        }
      });
    });

    /*******************************
     *     TASK MANAGEMENT LOGIC
     *******************************/
    let tasks = [];
    const taskTableBody = document.getElementById('taskTableBody');

    const filterAllBtn = document.getElementById('filterAllBtn');
    const filterTodayBtn = document.getElementById('filterTodayBtn');
    const filterUpcomingBtn = document.getElementById('filterUpcomingBtn');

    // Add/Edit Modal
    const modalOverlay = document.getElementById('modalOverlay');
    const modalTitle = document.getElementById('modalTitle');
    const taskForm = document.getElementById('taskForm');
    const taskNameInput = document.getElementById('taskName');
    const taskDescInput = document.getElementById('taskDescription');
    const taskDueDateInput = document.getElementById('taskDueDate');
    const taskPriorityInput = document.getElementById('taskPriority');
    const taskStatusInput = document.getElementById('taskStatus');
    const cancelBtn = document.getElementById('cancelBtn');
    const taskModalCloseBtn = document.getElementById('taskModalCloseBtn');
    const addTaskBtn = document.getElementById('addTaskBtn');

    let editTaskId = null;

    // Filter Modal
    const filterModalOverlay = document.getElementById('filterModalOverlay');
    const openFilterBtn = document.getElementById('openFilterBtn');
    const filterModalCloseBtn = document.getElementById('filterModalCloseBtn');
    const filterForm = document.getElementById('filterForm');
    const filterTextInput = document.getElementById('filterText');
    const filterDateFrom = document.getElementById('filterDateFrom');
    const filterDateTo = document.getElementById('filterDateTo');
    const clearFilterBtn = document.getElementById('clearFilterBtn');
    let currentFilter = { text:'', dateFrom:'', dateTo:'', priorities:[], statuses:[] };

    window.onload = function() {
      loadTasksFromLocalStorage();
      renderTasks(tasks);
    }

    function loadTasksFromLocalStorage() {
      const tasksJson = localStorage.getItem('tasks');
      if (tasksJson) tasks = JSON.parse(tasksJson);
      else tasks = [];
    }
    function saveTasksToLocalStorage() {
      localStorage.setItem('tasks', JSON.stringify(tasks));
    }

    function renderTasks(taskArray) {
      taskTableBody.innerHTML = '';
      if (!taskArray || taskArray.length===0) {
        taskTableBody.innerHTML = `
          <tr>
            <td colspan="5" class="px-6 py-4 text-center text-sm text-gray-500">No tasks found.</td>
          </tr>
        `;
        return;
      }
      taskArray.forEach(task => {
        let priorityBadgeColor = 'bg-green-100 text-green-800';
        if (task.priority === 'Medium') priorityBadgeColor = 'bg-yellow-100 text-yellow-800';
        if (task.priority === 'High') priorityBadgeColor = 'bg-red-100 text-red-800';
        let statusBadgeColor = 'bg-gray-100 text-gray-800';
        if (task.status==='Not Started') statusBadgeColor='bg-red-100 text-red-800';
        if (task.status==='In Progress') statusBadgeColor='bg-yellow-100 text-yellow-800';
        if (task.status==='Completed') statusBadgeColor='bg-green-100 text-green-800';

        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="px-6 py-4">
            <div class="flex items-center">
              <input type="checkbox" data-id="${task.id}" 
                class="h-4 w-4 text-custom border-gray-300 rounded mr-3 task-complete-checkbox"
                ${task.status==='Completed'?'checked':''} />
              <div>
                <p class="text-sm font-medium text-gray-900">${task.name}</p>
                <p class="text-sm text-gray-500">${task.description||''}</p>
              </div>
            </div>
          </td>
          <td class="px-6 py-4 text-sm text-gray-500">${task.dueDate}</td>
          <td class="px-6 py-4">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${priorityBadgeColor}">
              ${task.priority}
            </span>
          </td>
          <td class="px-6 py-4">
            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusBadgeColor}">
              ${task.status}
            </span>
          </td>
          <td class="px-6 py-4 text-sm">
            <button class="text-custom hover:text-custom-dark mr-3 editTaskBtn" data-id="${task.id}">
              <i class="fas fa-edit"></i>
            </button>
            <button class="text-red-600 hover:text-red-900 deleteTaskBtn" data-id="${task.id}">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        `;
        taskTableBody.appendChild(row);
      });
      document.querySelectorAll('.task-complete-checkbox').forEach(checkbox=>{
        checkbox.addEventListener('change', toggleTaskCompletion);
      });
      document.querySelectorAll('.editTaskBtn').forEach(btn=>{
        btn.addEventListener('click', handleEditTask);
      });
      document.querySelectorAll('.deleteTaskBtn').forEach(btn=>{
        btn.addEventListener('click', handleDeleteTask);
      });
    }

    addTaskBtn.addEventListener('click', () => {
      editTaskId = null;
      modalTitle.textContent='Add New Task';
      taskForm.reset();
      taskPriorityInput.value='Medium';
      taskStatusInput.value='In Progress';
      showModal(modalOverlay);
    });
    taskModalCloseBtn.addEventListener('click', ()=>hideModal(modalOverlay));
    cancelBtn.addEventListener('click', ()=>hideModal(modalOverlay));
    taskForm.addEventListener('submit', (e)=>{
      e.preventDefault();
      if (editTaskId) {
        const index = tasks.findIndex(t => t.id===editTaskId);
        if (index!==-1) {
          tasks[index].name=taskNameInput.value;
          tasks[index].description=taskDescInput.value;
          tasks[index].dueDate=taskDueDateInput.value;
          tasks[index].priority=taskPriorityInput.value;
          tasks[index].status=taskStatusInput.value;
        }
      } else {
        const newTask = {
          id: Date.now().toString(),
          name: taskNameInput.value,
          description: taskDescInput.value,
          dueDate: taskDueDateInput.value,
          priority: taskPriorityInput.value,
          status: taskStatusInput.value
        };
        tasks.push(newTask);
      }
      saveTasksToLocalStorage();
      hideModal(modalOverlay);
      applyAllFilters();
    });
    function handleEditTask(e) {
      const taskId = e.currentTarget.getAttribute('data-id');
      editTaskId = taskId;
      const taskToEdit = tasks.find(t=>t.id===taskId);
      if(taskToEdit){
        modalTitle.textContent='Edit Task';
        taskNameInput.value=taskToEdit.name;
        taskDescInput.value=taskToEdit.description;
        taskDueDateInput.value=taskToEdit.dueDate;
        taskPriorityInput.value=taskToEdit.priority;
        taskStatusInput.value=taskToEdit.status;
        showModal(modalOverlay);
      }
    }
    function handleDeleteTask(e) {
      const taskId=e.currentTarget.getAttribute('data-id');
      tasks=tasks.filter(t=>t.id!==taskId);
      saveTasksToLocalStorage();
      applyAllFilters();
    }
    function toggleTaskCompletion(e){
      const taskId=e.currentTarget.getAttribute('data-id');
      const idx=tasks.findIndex(t=>t.id===taskId);
      if(idx!==-1){
        if(e.currentTarget.checked) tasks[idx].status='Completed';
        else tasks[idx].status='In Progress';
        saveTasksToLocalStorage();
        applyAllFilters();
      }
    }

    filterAllBtn.addEventListener('click', ()=>{
      currentFilter={ text:'', dateFrom:'', dateTo:'', priorities:[], statuses:[] };
      filterForm.reset();
      renderTasks(tasks);
    });
    filterTodayBtn.addEventListener('click', ()=>{
      const today=new Date().toISOString().slice(0,10);
      const filtered=tasks.filter(t=>t.dueDate===today);
      renderTasks(filtered);
    });
    filterUpcomingBtn.addEventListener('click', ()=>{
      const today=new Date().toISOString().slice(0,10);
      const filtered=tasks.filter(t=>t.dueDate>today);
      renderTasks(filtered);
    });

    openFilterBtn.addEventListener('click', ()=>{
      filterTextInput.value=currentFilter.text||'';
      filterDateFrom.value=currentFilter.dateFrom||'';
      filterDateTo.value=currentFilter.dateTo||'';
      document.querySelectorAll('.priority-checkbox').forEach(chk=>{
        chk.checked=currentFilter.priorities.includes(chk.value);
      });
      document.querySelectorAll('.status-checkbox').forEach(chk=>{
        chk.checked=currentFilter.statuses.includes(chk.value);
      });
      showModal(filterModalOverlay);
    });
    filterModalCloseBtn.addEventListener('click', ()=>hideModal(filterModalOverlay));
    clearFilterBtn.addEventListener('click', ()=>{
      currentFilter={ text:'', dateFrom:'', dateTo:'', priorities:[], statuses:[] };
      filterForm.reset();
      hideModal(filterModalOverlay);
      renderTasks(tasks);
    });
    filterForm.addEventListener('submit', (e)=>{
      e.preventDefault();
      currentFilter.text=filterTextInput.value.trim();
      currentFilter.dateFrom=filterDateFrom.value;
      currentFilter.dateTo=filterDateTo.value;
      currentFilter.priorities=[];
      currentFilter.statuses=[];
      document.querySelectorAll('.priority-checkbox').forEach(chk=>{
        if(chk.checked) currentFilter.priorities.push(chk.value);
      });
      document.querySelectorAll('.status-checkbox').forEach(chk=>{
        if(chk.checked) currentFilter.statuses.push(chk.value);
      });
      hideModal(filterModalOverlay);
      applyAllFilters();
    });
    function applyAllFilters(){
      let filtered=[...tasks];
      if(currentFilter.text){
        const lower=currentFilter.text.toLowerCase();
        filtered=filtered.filter(t=>
          (t.name && t.name.toLowerCase().includes(lower))||
          (t.description && t.description.toLowerCase().includes(lower))
        );
      }
      if(currentFilter.dateFrom){
        filtered=filtered.filter(t=>t.dueDate>=currentFilter.dateFrom);
      }
      if(currentFilter.dateTo){
        filtered=filtered.filter(t=>t.dueDate<=currentFilter.dateTo);
      }
      if(currentFilter.priorities.length>0){
        filtered=filtered.filter(t=>currentFilter.priorities.includes(t.priority));
      }
      if(currentFilter.statuses.length>0){
        filtered=filtered.filter(t=>currentFilter.statuses.includes(t.status));
      }
      renderTasks(filtered);
    }

    function showModal(overlay) {
      document.documentElement.classList.add('modal-active');
      overlay.style.display='block';
    }
    function hideModal(overlay) {
      document.documentElement.classList.remove('modal-active');
      overlay.style.display='none';
    }
  </script>
</body>
</html>
